import{s as n,B as r,E as s,C as a}from"./index.25c5763d.js";import{u as d}from"./userStore.df57d0cc.js";import{a as g}from"./friend.2ac2f8da.js";const l=d(),{token:h}=n(l),p=r("friends",{state:()=>({fSearchHistory:"",gSearchHistory:"",fLoading:!1,fNodata:!1,gLoading:!1,gNodata:!1,fList:[],gList:[],counter:0,fPage:{pageSize:7,pageNum:1},gPage:{pageSize:7,pageNum:1}}),actions:{loadNewFriends(){if(!this.fLoading&&!this.fNodata){this.fLoading=!0;let e=this.fSearchHistory;(e==null||e=="")&&(e="-1"),g(h.value,e,this.fPage).then(t=>{t.data.success?t.data.data.length>0?(this.fList==null?this.fList=t.data.data:this.fList.push(...t.data.data),this.fPage.pageNum+=1):this.fNodata=!0:s({type:"error",message:t.data.msg,showClose:!0,grouping:!0})}).catch(t=>{s({type:"error",message:a.global.t("newFriendList.loadError"),showClose:!0,grouping:!0}),console.log(t)}).finally(()=>{this.fLoading=!1})}},loadNewGFriends(e){if(!this.gLoading&&!this.gNodata){this.gLoading=!0;let t=this.gSearchHistory;(t==null||t=="")&&(t="-1"),g(h.value,t,this.gPage).then(i=>{i.data.success?i.data.data.length>0?(this.gList==null?this.gList=this.getDiff(i.data.data,e):(this.gList.push(...i.data.data),this.gList=this.getGList(e)),this.gPage.pageNum+=1):this.gNodata=!0:s({type:"error",message:i.data.msg,showClose:!0,grouping:!0})}).catch(i=>{s({type:"error",message:a.global.t("newFriendList.loadError"),showClose:!0,grouping:!0}),console.log(i)}).finally(()=>{this.gLoading=!1})}},loadFirstList(){this.fLoading=!1,this.fNodata=!1,this.fPage.pageNum=1,this.counter=0,this.fList!=null&&this.fList.splice(0,this.fList.length),this.loadNewFriends()},loadNewFriendsTest(){let e=this.fSearchHistory;for(let t=0;t<this.fPage.pageSize;t++){let i=[{id:this.counter.toString(),uname:e+this.counter.toString(),avatar:"https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg"}];this.fList==null?this.fList=i:this.fList.push(...i),this.counter+=1}},loadFirstGList(e){if(this.gLoading=!1,this.gNodata=!1,this.gPage.pageNum=1,this.counter=0,this.gList!=null&&this.gList.splice(0,this.gList.length),this.loadNewGFriends(e),!(this.gList.length<7))for(this.gList=this.getGList(e);this.gList.length<=7;)this.loadNewGFriends(),this.gList=this.getGList(e)},loadNewGFriendsTest(){let e=this.gSearchHistory;for(let t=0;t<this.gPage.pageSize;t++){let i=[{id:this.counter.toString(),uname:e+this.counter.toString(),avatar:"https://fuss10.elemecdn.com/a/3f/3302e58f9a181d2509f3dc0fa68b0jpeg.jpeg"}];this.gList==null?this.gList=i:this.gList.push(...i),this.counter+=1}},getGList(e){return this.getDiff(this.gList,e)},getDiff(e,t){return e.filter(function(f){return!t.some(function(o){return f.id==o.id})})},delGItem(e){for(let t=0;t<this.gList.length;t++)if(e==this.gList[t].id){let i=this.gList[t];return this.gList.splice(t,1),this.gList.length<=7&&this.loadNewGFriends(),i}},delItem(e){for(let t=0;t<this.fList.length;t++)if(e==this.fList[t].id){this.fList.splice(t,1),this.fList.length<=7&&this.loadNewFriends();return}}}});export{p as u};
