import{A as E}from"./AcceptableItem.95d03f94.js";import{e as C,r as d}from"./friend.2ac2f8da.js";import{u as R}from"./userStore.df57d0cc.js";import{s as F,r as u,b as _,c as N,w as j,d as x,e as k,f as n,g as l,h,i as A,m as I,F as B,n as D,l as v,E as a}from"./index.25c5763d.js";import{_ as S}from"./_plugin-vue_export-helper.cdc0426e.js";/* empty css                                                                       */const z={class:"infinite-list"},M={__name:"RequestList",setup(T){const L=R(),{token:i}=F(L),c=u(!1),p=u(!1),f=_({pageSize:5,pageNum:1}),{t:s}=N(),r=_([]);u(0);function g(e){for(let t=0;t<r.length;t++)if(e==r[t].id){r.splice(t,1);return}}function m(){!p.value&&!c.value&&(c.value=!0,C(i.value,f).then(e=>{e.data.success?e.data.data.length>0?(r.push(...e.data.data),f.pageNum+=1):p.value=!0:a({type:"error",message:s("reqList.loadError"),showClose:!0,grouping:!0})}).catch(e=>{a({type:"error",message:s("reqList.loadError"),showClose:!0,grouping:!0}),console.log(e)}).finally(()=>{c.value=!1}))}function b(e){d(i.value,e,!0).then(t=>{t.data.success?g(e):a({type:"error",message:s("reqList.acceptError"),showClose:!0,grouping:!0})}).catch(t=>{a({type:"error",message:s("reqList.acceptError"),showClose:!0,grouping:!0}),console.log(t)}).finally(()=>{})}function y(e){d(i.value,e,!1).then(t=>{t.data.success?g(e):a({type:"error",message:s("reqList.rejectError"),showClose:!0,grouping:!0})}).catch(t=>{a({type:"error",message:s("reqList.rejectError"),showClose:!0,grouping:!0}),console.log(t)}).finally(()=>{})}return j(()=>r.length,e=>{e<=5&&m()}),(e,t)=>{const q=x("el-scrollbar"),w=k("infinite-scroll");return n(),l("div",null,[h(q,{height:"75vh",id:"all"},{default:A(()=>[I((n(),l("ul",z,[(n(!0),l(B,null,D(r,o=>(n(),l("li",{key:o.id},[h(E,{avatar:o.friendAvatar,senderName:o.friendName,message:o.msg,"button-label1":v(s)("reqList.accept"),"button-label2":v(s)("reqList.reject"),id:o.id,onAccept:b,onReject:y},null,8,["avatar","senderName","message","button-label1","button-label2","id"])]))),128))])),[[w,m]])]),_:1})])}}},O=S(M,[["__scopeId","data-v-96361f24"]]);export{O as default};
